<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CS 416 Data Visualization: Narrative Visualization Project</title>
</head>
<body onload="init()">
<svg width=1500 height=1000></svg>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>
<script>
    const canvas = d3.select('svg');
    canvas.append('image')
        .attr('xlink:href', "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Olympic_rings_without_rims.svg/2560px-Olympic_rings_without_rims.svg.png")
        .attr('width', 200)
        .attr('height', 80)
        .attr('y', 10);
    canvas.append('text')
        .attr('x', 220)
        .attr('y', 50)
        .attr('stroke', 'blue')
        .attr('fill', 'orange')
        .style('font-size', 50)
        .text("Data-Driven Olympics");
    canvas.append('text')
        .attr('x', 220)
        .attr('y', 85)
        .attr('fill', 'blue')
        .style('font-size', 24)
        .text("Exploring Olympic medal count by year, IOC nation, and event category");
    canvas.append('path')
        .attr('d', d3.line()([[10, 100], [1490, 100]]))
        .attr('stroke', 'black');

    const X_SCALE = d3.scaleLinear().domain([1880, 2010]).range([0, 1380]);
    const Y_SCALE = d3.scaleLinear().domain([0, 500]).range([900, 100]);

    const SUMMER_DATA = d3.csv("https://armhoeft.github.io/data/summer.csv");
    const WINTER_DATA = d3.csv("https://armhoeft.github.io/data/winter.csv");

    async function displayMedalsByYear() {
        const chart = d3.select('#chart-area');
        chart.data(SUMMER_DATA).enter()
        .append('rect')
        .attr('class', 'bar')
        .attr('x', function(d, i) { return X_SCALE})
    }

    async function init() {
        const xAxis = d3.axisBottom(X_SCALE)
            .tickValues([1880, 1890, 1900, 1910, 1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010])
            .tickFormat(d3.format("~y"));

        const yAxis = d3.axisLeft(Y_SCALE)
            .tickValues([0, 50, 100, 150, 200, 250, 300, 350, 400, 450, 500])
            .tickFormat(d3.format("~s"));

        // Create display canvas
        const canvas = d3.select('svg').append('g')
            .attr('id', 'canvas')
            .attr('transform', 'translate(80,30)');
        // Display Axes
        canvas.append('g')
            .call(yAxis);
        canvas.append('g')
            .attr('transform', "translate(0,900)")
            .call(xAxis)
        canvas.append('text')
            .attr('x', -550)
            .attr('y', -40)
            .attr('transform', 'rotate(-90)')
            .attr('fill', 'black')
            .style('font-size', 16)
            .text("Medal Count");
        canvas.append('rect')
            .attr('id', 'chart-area')
            .attr('transform', 'translate(1,100)')
            .attr('fill', '#F8F8F8')
            .attr('width', 1380)
            .attr('height', 800);

        await displayMedalsByYear();
    }

    function groupData(data, groupBy) {
        const groups = {};
        data.forEach(function (d, i) {
            const k = d[groupBy];
            groups[k] || (groups[k] = []);
            groups[k].push(d);
        });
        return data;
    }
</script>
</body>
</html>
